<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Adaptive weigths smoothing using patches — paws • aws</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Adaptive weigths smoothing using patches — paws" />
<meta property="og:description" content="The function implements a version the propagation separation approach that
uses patches instead of individuel voxels for comparisons in parameter space. Functionality is analog to function aws. Using patches allows for an improved
handling of locally smooth functions and in 2D and 3D for improved smoothness of
discontinuities at the expense of increased computing time." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aws</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Adaptive weigths smoothing using patches</h1>
    
    <div class="hidden name"><code>paws.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function implements a version the propagation separation approach that
uses patches instead of individuel voxels for comparisons in parameter space. Functionality is analog to function <code><a href='aws.html'>aws</a></code>. Using patches allows for an improved
handling of locally smooth functions and in 2D and 3D for improved smoothness of
discontinuities at the expense of increased computing time.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>paws</span><span class='op'>(</span><span class='va'>y</span>, hmax <span class='op'>=</span> <span class='cn'>NULL</span>, mask<span class='op'>=</span><span class='cn'>NULL</span>, onestep <span class='op'>=</span> <span class='cn'>FALSE</span>, aws <span class='op'>=</span> <span class='cn'>TRUE</span>, family <span class='op'>=</span> <span class='st'>"Gaussian"</span>,
     lkern <span class='op'>=</span> <span class='st'>"Triangle"</span>, aggkern <span class='op'>=</span> <span class='st'>"Uniform"</span>, sigma2 <span class='op'>=</span> <span class='cn'>NULL</span>, shape <span class='op'>=</span> <span class='cn'>NULL</span>,
     scorr <span class='op'>=</span> <span class='fl'>0</span>, spmin <span class='op'>=</span> <span class='fl'>0.25</span>, ladjust <span class='op'>=</span> <span class='fl'>1</span>, wghts <span class='op'>=</span> <span class='cn'>NULL</span>, u <span class='op'>=</span> <span class='cn'>NULL</span>,
     graph <span class='op'>=</span> <span class='cn'>FALSE</span>, demo <span class='op'>=</span> <span class='cn'>FALSE</span>, patchsize <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>array <code>y</code> containing the observe response (image intensity) data.
  <code>dim(y)</code> determines the dimensionality and extend of the grid design.</p></td>
    </tr>
    <tr>
      <th>mask</th>
      <td><p>logical array defining a mask. All computations are restricted to the mask.</p></td>
    </tr>
    <tr>
      <th>hmax</th>
      <td><p><code>hmax</code> specifies the maximal bandwidth. Defaults to <code>hmax=250, 12, 5</code>
  for 1D, 2D, 3D images, respectively.
  In case of <code>lkern="Gaussian"</code> the bandwidth is assumed to be given in full width half maximum (FWHM) units, i.e., <code>0.42466</code> times gridsize.</p></td>
    </tr>
    <tr>
      <th>onestep</th>
      <td><p>apply the last step only (use for test purposes only)</p></td>
    </tr>
    <tr>
      <th>aws</th>
      <td><p>logical: if TRUE structural adaptation (AWS) is used.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p><code>family</code> specifies the probability distribution. Default is <code>family="Gaussian"</code>, also implemented
   are "Bernoulli", "Poisson", "Exponential", "Volatility", "Variance" and "NCchi". <code>family="Volatility"</code> specifies a Gaussian distribution with
   expectation 0 and unknown variance. <code>family="Volatility"</code> specifies that <code>p*y/theta</code> is distributed as \(\chi^2\) with <code>p=shape</code>
   degrees of freedom. <code>family="NCchi"</code> uses a noncentral Chi distribution with <code>p=shape</code> degrees of freedom and noncentrality parameter <code>theta</code></p></td>
    </tr>
    <tr>
      <th>lkern</th>
      <td><p>character: location kernel, either "Triangle", "Plateau", "Quadratic", "Cubic" or "Gaussian".
The default "Triangle" is equivalent to using an Epanechnikov kernel, "Quadratic" and  "Cubic" refer to a Bi-weight and Tri-weight
 kernel, see Fan and Gijbels (1996). "Gaussian" is a truncated (compact support) Gaussian kernel.
 This is included for comparisons only and should be avoided due to its large computational costs.</p></td>
    </tr>
    <tr>
      <th>aggkern</th>
      <td><p>character: kernel used in stagewise aggregation, either "Triangle" or "Uniform"</p></td>
    </tr>
    <tr>
      <th>sigma2</th>
      <td><p><code>sigma2</code> allows to specify the variance in case of <code>family="Gaussian"</code>. Not used if <code>family!="Gaussian"</code>.
   Defaults to <code>NULL</code>. In this case a homoskedastic variance estimate is generated. If <code>length(sigma2)==length(y)</code> then <code>sigma2</code>
   is assumed to contain the pointwise variance of <code>y</code> and a heteroscedastic variance model is used.</p></td>
    </tr>
    <tr>
      <th>shape</th>
      <td><p>Allows to specify an additional shape parameter for certain family models. Currently only used for family="Variance", that is \(\chi\)-Square distributed observations
  with <code>shape</code> degrees of freedom.</p></td>
    </tr>
    <tr>
      <th>scorr</th>
      <td><p>The vector <code>scorr</code> allows to specify a first order correlations of the noise for each coordinate direction,
    defaults to 0 (no correlation).</p></td>
    </tr>
    <tr>
      <th>spmin</th>
      <td><p>Determines the form (size of the plateau) in the adaptation kernel.
    Not to be changed by the user.</p></td>
    </tr>
    <tr>
      <th>ladjust</th>
      <td><p>factor to increase the default value of lambda</p></td>
    </tr>
    <tr>
      <th>wghts</th>
      <td><p><code>wghts</code> specifies the  diagonal elements of a weight matrix to adjust for different distances between grid-points
  in different coordinate directions, i.e. allows to define a more appropriate metric in the design space.</p></td>
    </tr>
    <tr>
      <th>u</th>
      <td><p>a "true" value of the regression function, may be provided to
   report risks at each iteration. This can be used to test the propagation condition with <code>u=0</code></p></td>
    </tr>
    <tr>
      <th>graph</th>
      <td><p>If  <code>graph=TRUE</code> intermediate results are illustrated after each iteration step. Defaults to <code>graph=FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>demo</th>
      <td><p>If <code>demo=TRUE</code> the function pauses after each iteration. Defaults to <code>demo=FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>patchsize</th>
      <td><p>positive integer defining the size of patches. Number of grid points within the patch is <code>(2*patchsize+1)^d</code> with <code>d</code> denoting the dimensionality of the design.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>see <code><a href='aws.html'>aws</a>. The procedure is supposed to produce superior results if the assumption of a local constant image is violated or if smooothness of discontinuities is desired.</code></p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns an object of class <code>aws</code> with slots</p>
<dt>y = "numeric"</dt><dd><p>y</p></dd>
                        <dt>dy = "numeric"</dt><dd><p>dim(y)</p></dd>
                        <dt>x = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>ni = "integer"</dt><dd><p>integer(0)</p></dd>
                        <dt>mask = "logical"</dt><dd><p>logical(0)</p></dd>
                        <dt>theta = "numeric"</dt><dd><p>Estimates of regression function, <code>length: length(y)</code></p></dd>
                        <dt>hseq = "numeric"</dt><dd><p>sequence of bandwidths employed</p></dd>
                        <dt>mae = "numeric"</dt><dd><p>Mean absolute error for each iteration step if u was specified,  numeric(0) else</p></dd>
                        <dt>psnr = "numeric"</dt><dd><p>Peak signal-to-noise ratio for each iteration step if u was specified,  numeric(0) else</p></dd>
                        <dt>var = "numeric"</dt><dd><p>approx. variance of the estimates of the regression function. Please note that this does not reflect variability due to randomness of weights.</p></dd>
                        <dt>xmin = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>xmax = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>wghts = "numeric"</dt><dd><p>numeric(0), ratio of distances <code>wghts[-1]/wghts[1]</code></p></dd>
                        <dt>degree = "integer"</dt><dd><p>0</p></dd>
                        <dt>hmax  = "numeric"</dt><dd><p>effective hmax</p></dd>
                        <dt>sigma2  = "numeric"</dt><dd><p>provided or estimated error variance</p></dd>
                        <dt>scorr = "numeric"</dt><dd><p>scorr</p></dd>
                        <dt>family = "character"</dt><dd><p>family</p></dd>
                        <dt>shape = "numeric"</dt><dd><p>shape</p></dd>
                        <dt>lkern  = "integer"</dt><dd><p>integer code for lkern,
                        1="Plateau", 2="Triangle", 3="Quadratic", 4="Cubic", 5="Gaussian"</p></dd>
                        <dt>lambda = "numeric"</dt><dd><p>effective value of lambda</p></dd>
                        <dt>ladjust = "numeric"</dt><dd><p>effective value of ladjust</p></dd>
                        <dt>aws = "logical"</dt><dd><p>aws</p></dd>
                        <dt>memory = "logical"</dt><dd><p>memory</p></dd>
                        <dt>homogen = "logical"</dt><dd><p>homogen</p></dd>
                        <dt>earlystop = "logical"</dt><dd><p>FALSE</p></dd>
                        <dt>varmodel = "character"</dt><dd><p>"Constant"</p></dd>
                        <dt>vcoef = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>call = "function"</dt><dd><p>the arguments of the call to <code>aws</code></p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>J. Polzehl, K. Tabelow (2019). Magnetic Resonance Brain Imaging:
             Modeling and Data Analysis Using R. Springer, Use R! series. Appendix A.
             Doi:10.1007/978-3-030-29184-6.</p>
<p>J. Polzehl, K. Papafitsoros, K. Tabelow. Patch-wise adaptive weights smoothing,
             Preprint no. 2520, WIAS, Berlin, 2018, DOI 10.20347/WIAS.PREPRINT.2520.
             (to appear in Journal of Statistical Software).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Joerg Polzehl, <a href='mailto:polzehl@wias-berlin.de'>polzehl@wias-berlin.de</a>,
<a href='http://www.wias-berlin.de/people/polzehl/'>http://www.wias-berlin.de/people/polzehl/</a></p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>use <code>setCores='number of threads'</code> to enable parallel execution.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See also <code><a href='aws.html'>aws</a></code>, <code><a href='lpaws.html'>lpaws</a></code>, <code><a href='vpaws.html'>vpaws</a></code>,<code>link{awsdata}</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/awsMethods/man/setCores.html'>setCores</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>64</span><span class='op'>^</span><span class='fl'>3</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>64</span>,<span class='fl'>64</span>,<span class='fl'>64</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>yhat</span> <span class='op'>&lt;-</span> <span class='fu'>paws</span><span class='op'>(</span><span class='va'>y</span>,hmax<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Joerg Polzehl.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


