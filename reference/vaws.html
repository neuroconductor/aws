<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>vector valued version of function aws
The function implements the propagation separation approach to
nonparametric smoothing (formerly introduced as Adaptive weights smoothing)
for varying coefficient likelihood models with vector valued response on a 1D, 2D or 3D grid. — vaws • aws</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="vector valued version of function aws
The function implements the propagation separation approach to
nonparametric smoothing (formerly introduced as Adaptive weights smoothing)
for varying coefficient likelihood models with vector valued response on a 1D, 2D or 3D grid. — vaws" />
<meta property="og:description" content="The function implements a version the propagation separation approach that
uses vector valued instead of scalar responses." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aws</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>vector valued version of function <code><a href='aws.html'>aws</a></code>
The function implements the propagation separation approach to
nonparametric smoothing (formerly introduced as Adaptive weights smoothing)
for varying coefficient likelihood models with vector valued response on a 1D, 2D or 3D grid.</h1>
    
    <div class="hidden name"><code>vaws.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function implements a version the propagation separation approach that
uses vector valued instead of scalar responses.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>vaws</span><span class='op'>(</span><span class='va'>y</span>, kstar <span class='op'>=</span> <span class='fl'>16</span>, sigma2 <span class='op'>=</span> <span class='fl'>1</span>, mask <span class='op'>=</span> <span class='cn'>NULL</span>, scorr <span class='op'>=</span> <span class='fl'>0</span>, spmin <span class='op'>=</span> <span class='fl'>0.25</span>,
     ladjust <span class='op'>=</span> <span class='fl'>1</span>, wghts <span class='op'>=</span> <span class='cn'>NULL</span>, u <span class='op'>=</span> <span class='cn'>NULL</span>, maxni <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>vawscov</span><span class='op'>(</span><span class='va'>y</span>, kstar <span class='op'>=</span> <span class='fl'>16</span>, invcov <span class='op'>=</span> <span class='cn'>NULL</span>, mask <span class='op'>=</span> <span class='cn'>NULL</span>, scorr <span class='op'>=</span> <span class='fl'>0</span>, spmin <span class='op'>=</span> <span class='fl'>0.25</span>,
          ladjust <span class='op'>=</span> <span class='fl'>1</span>, wghts <span class='op'>=</span> <span class='cn'>NULL</span>, u <span class='op'>=</span> <span class='cn'>NULL</span>, maxni <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p><code>y</code> contains the observed response data. <code>dim(y)</code> determines the dimensionality and extend of the grid design. First component varies over components of the response vector.</p></td>
    </tr>
    <tr>
      <th>kstar</th>
      <td><p>maximal number of steps to employ. Determines maximal bandwidth.</p></td>
    </tr>
    <tr>
      <th>sigma2</th>
      <td><p>specifies a homogeneous error variance.</p></td>
    </tr>
    <tr>
      <th>invcov</th>
      <td><p>array of voxelwise inverse covariance matrixes, first index corresponds to
 upper diagonal inverse covariance matrix.</p></td>
    </tr>
    <tr>
      <th>mask</th>
      <td><p>logical mask. All computations are restrikted to design poins within the mask.</p></td>
    </tr>
    <tr>
      <th>scorr</th>
      <td><p>The vector <code>scorr</code> allows to specify a first order correlations of the noise for each coordinate direction,
    defaults to 0 (no correlation).</p></td>
    </tr>
    <tr>
      <th>spmin</th>
      <td><p>determines the form (size of the plateau) in the adaptation kernel.
    Not to be changed by the user.</p></td>
    </tr>
    <tr>
      <th>ladjust</th>
      <td><p>factor to increase the default value of lambda</p></td>
    </tr>
    <tr>
      <th>wghts</th>
      <td><p><code>wghts</code> specifies the  diagonal elements of a weight matrix to adjust for different distances between grid-points
  in different coordinate directions, i.e. allows to define a more appropriate metric in the design space.</p></td>
    </tr>
    <tr>
      <th>u</th>
      <td><p>a "true" value of the regression function, may be provided to
   report risks at each iteration. This can be used to test the propagation condition with <code>u=0</code></p></td>
    </tr>
    <tr>
      <th>maxni</th>
      <td><p>If TRUE use \(max_{l&lt;=k}(N_i^{(l)}\) instead of \((N_i^{(k)}\) in the definition of the statistical penalty.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>see <code><a href='aws.html'>aws</a></code>. Expets vector valued responses. Currently only implements the case of additive Gaussian errors.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns anobject of class <code>aws</code> with slots</p>
<dt>y = "numeric"</dt><dd><p>y</p></dd>
                        <dt>dy = "numeric"</dt><dd><p>dim(y)</p></dd>
                        <dt>x = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>ni = "integer"</dt><dd><p>integer(0)</p></dd>
                        <dt>mask = "logical"</dt><dd><p>logical(0)</p></dd>
                        <dt>theta = "numeric"</dt><dd><p>Estimates of regression function, <code>length: length(y)</code></p></dd>
                        <dt>hseq = "numeric"</dt><dd><p>sequence of bandwidths employed</p></dd>
                        <dt>mae = "numeric"</dt><dd><p>Mean absolute error for each iteration step if u was specified,  numeric(0) else</p></dd>
                        <dt>psnr = "numeric"</dt><dd><p>Peak signal-to-noise ratio for each iteration step if u was specified,  numeric(0) else</p></dd>
                        <dt>var = "numeric"</dt><dd><p>approx. variance of the estimates
                            of the regression function.
                            Please note that this does not reflect variability due to
                            randomness of weights.</p></dd>
                        <dt>xmin = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>xmax = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>wghts = "numeric"</dt><dd><p>numeric(0), ratio of distances <code>wghts[-1]/wghts[1]</code></p></dd>
                        <dt>degree = "integer"</dt><dd><p>0</p></dd>
                        <dt>hmax  = "numeric"</dt><dd><p>effective hmax</p></dd>
                        <dt>sigma2  = "numeric"</dt><dd><p>provided or estimated (inverse) error variance</p></dd>
                        <dt>scorr = "numeric"</dt><dd><p>scorr</p></dd>
                        <dt>family = "character"</dt><dd><p>family</p></dd>
                        <dt>shape = "numeric"</dt><dd><p>shape</p></dd>
                        <dt>lkern  = "integer"</dt><dd><p>integer code for lkern,
                        1="Plateau", 2="Triangle", 3="Quadratic", 4="Cubic", 5="Gaussian"</p></dd>
                        <dt>lambda = "numeric"</dt><dd><p>effective value of lambda</p></dd>
                        <dt>ladjust = "numeric"</dt><dd><p>effective value of ladjust</p></dd>
                        <dt>aws = "logical"</dt><dd><p>aws</p></dd>
                        <dt>memory = "logical"</dt><dd><p>memory</p></dd>
                        <dt>homogen = "logical"</dt><dd><p>homogen</p></dd>
                        <dt>earlystop = "logical"</dt><dd><p>FALSE</p></dd>
                        <dt>varmodel = "character"</dt><dd><p>"Constant"</p></dd>
                        <dt>vcoef = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>call = "function"</dt><dd><p>the arguments of the call to <code>aws</code></p></dd>


    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>J. Polzehl, K. Tabelow (2019). Magnetic Resonance Brain Imaging:
             Modeling and Data Analysis Using R. Springer, Use R! series. Appendix A.
             Doi:10.1007/978-3-030-29184-6.</p>
<p>J. Polzehl, V. Spokoiny,  Adaptive Weights Smoothing with applications to image restoration,
J. R. Stat. Soc. Ser. B Stat. Methodol.  62 ,  (2000)  , pp. 335--354. DOI:10.1111/1467-9868.00235.</p>
<p>J. Polzehl, V. Spokoiny,  Propagation-separation approach for local likelihood estimation,
Probab. Theory Related Fields  135 (3),  (2006)  , pp. 335--362. DOI:10.1007/s00440-005-0464-1.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Joerg Polzehl, <a href='mailto:polzehl@wias-berlin.de'>polzehl@wias-berlin.de</a>,
<a href='http://www.wias-berlin.de/people/polzehl/'>http://www.wias-berlin.de/people/polzehl/</a></p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>use <code>setCores='number of threads'</code> to enable parallel execution.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See also <code><a href='aws.html'>aws</a></code>, <code><a href='vpaws.html'>vpaws</a></code>,<code>link{awsdata}</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/awsMethods/man/setCores.html'>setCores</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>*</span><span class='fl'>64</span><span class='op'>^</span><span class='fl'>3</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>64</span>,<span class='fl'>64</span>,<span class='fl'>64</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>yhat</span> <span class='op'>&lt;-</span> <span class='fu'>vaws</span><span class='op'>(</span><span class='va'>y</span>,kstar<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Joerg Polzehl.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


