<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Segmentation by adaptive weights for Gaussian models. — aws.segment • aws</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Segmentation by adaptive weights for Gaussian models. — aws.segment" />
<meta property="og:description" content="The function implements a modification of the adaptive weights smoothing algorithm for
segmentation into three classes. The" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aws</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Segmentation by adaptive weights for Gaussian models.</h1>
    
    <div class="hidden name"><code>aws.segment.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function implements a modification of the adaptive weights smoothing algorithm for
segmentation into three classes. The</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>aws.segment</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>level</span>, delta <span class='op'>=</span> <span class='fl'>0</span>, hmax <span class='op'>=</span> <span class='cn'>NULL</span>, hpre <span class='op'>=</span> <span class='cn'>NULL</span>, mask <span class='op'>=</span><span class='cn'>NULL</span>,
            varmodel <span class='op'>=</span> <span class='st'>"Constant"</span>, lkern <span class='op'>=</span> <span class='st'>"Triangle"</span>, scorr <span class='op'>=</span> <span class='fl'>0</span>, ladjust <span class='op'>=</span> <span class='fl'>1</span>,
            wghts <span class='op'>=</span> <span class='cn'>NULL</span>, u <span class='op'>=</span> <span class='cn'>NULL</span>, varprop <span class='op'>=</span> <span class='fl'>0.1</span>, ext <span class='op'>=</span> <span class='fl'>0</span>, graph <span class='op'>=</span> <span class='cn'>FALSE</span>,
            demo <span class='op'>=</span> <span class='cn'>FALSE</span>, fov<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p><code>y</code> contains the observed response data. <code>dim(y)</code> determines the dimensionality and extend of the grid design.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>center of second class</p></td>
    </tr>
    <tr>
      <th>delta</th>
      <td><p>half width of second class</p></td>
    </tr>
    <tr>
      <th>hmax</th>
      <td><p><code>hmax</code> specifies the maximal bandwidth. Defaults to <code>hmax=250, 12, 5</code> for <code>dd=1, 2, 3</code>, respectively.</p></td>
    </tr>
    <tr>
      <th>hpre</th>
      <td><p>Describe <code>hpre</code> Bandwidth used for an initial nonadaptive estimate. The first estimate
   of variance parameters  is obtained from residuals with respect to this estimate.</p></td>
    </tr>
    <tr>
      <th>mask</th>
      <td><p>optional logical mask, same dimensionality as <code>y</code></p></td>
    </tr>
    <tr>
      <th>varmodel</th>
      <td><p>Implemented are "Constant", "Linear" and "Quadratic" refering to a polynomial model of degree 0 to 2.</p></td>
    </tr>
    <tr>
      <th>lkern</th>
      <td><p>character: location kernel, either "Triangle", "Plateau", "Quadratic", "Cubic" or "Gaussian".
  The default "Triangle" is equivalent to using an Epanechnikov kernel, "Quadratic" and  "Cubic" refer to a Bi-weight and Tri-weight
   kernel, see Fan and Gijbels (1996). "Gaussian" is a truncated (compact support) Gaussian kernel.
   This is included for comparisons only and should be avoided due to its large computational costs.</p></td>
    </tr>
    <tr>
      <th>scorr</th>
      <td><p>The vector <code>scorr</code> allows to specify a first order correlations of the noise for each coordinate direction,
    defaults to 0 (no correlation).</p></td>
    </tr>
    <tr>
      <th>ladjust</th>
      <td><p>factor to increase the default value of lambda</p></td>
    </tr>
    <tr>
      <th>wghts</th>
      <td><p><code>wghts</code> specifies the  diagonal elements of a weight matrix to adjust for different distances between grid-points
  in different coordinate directions, i.e. allows to define a more appropriate metric in the design space.</p></td>
    </tr>
    <tr>
      <th>u</th>
      <td><p>a "true" value of the regression function, may be provided to
   report risks at each iteration. This can be used to test the propagation condition with <code>u=0</code></p></td>
    </tr>
    <tr>
      <th>varprop</th>
      <td><p>Small variance estimates are replaced by <code>varprop</code> times the mean variance.</p></td>
    </tr>
    <tr>
      <th>ext</th>
      <td><p>Intermediate results are fixed if the test statistics exceeds the critical value by <code>ext</code>.</p></td>
    </tr>
    <tr>
      <th>graph</th>
      <td><p>If  <code>graph=TRUE</code> intermediate results are illustrated after each iteration step. Defaults to <code>graph=FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>demo</th>
      <td><p>If <code>demo=TRUE</code> the function pauses after each iteration. Defaults to <code>demo=FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>fov</th>
      <td><p>Field of view. Size of region (sample size) to adjust for in multiscale testing.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The image is segmented into three parts by performing multiscale tests
of the hypotheses H1
<code>value &gt;= level - delta</code> and H2 <code>value &lt;= level + delta</code>.
Pixel where the first hypotesis is rejected are classified as <code>-1</code> (segment 1)
while rejection of H2 results in classification  <code>1</code> (segment 3).
Pixel where neither H1 or H2 are rejected ar assigned to a value <code>0</code> (segment 2). Critical values for the tests are adjusted for smoothness at the different scales inspected in the iteration process using results from multiscale testing,
see e.g. Duembgen and Spokoiny (2001). Critical values also depend on the
size of the region of interest specified in parameter <code>fov</code>.</p>
<p>Within segment 2 structural adaptive smoothing is performed while if a pair of pixel belongs to segment 1 or segment 3 the corresponding weight will be nonadaptive.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns anobject of class <code>aws</code> with slots</p>
<dt>y = "numeric"</dt><dd><p>y</p></dd>
                        <dt>dy = "numeric"</dt><dd><p>dim(y)</p></dd>
                        <dt>x = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>ni = "integer"</dt><dd><p>integer(0)</p></dd>
                        <dt>mask = "logical"</dt><dd><p>logical(0)</p></dd>
                        <dt>segment = "integer"</dt><dd><p>Segmentation results, class numbers 1-3</p></dd>
                        <dt>theta = "numeric"</dt><dd><p>Estimates of regression function, <code>length: length(y)</code></p></dd>
                        <dt>mae = "numeric"</dt><dd><p>Mean absolute error for each iteration step if u was specified,  numeric(0) else</p></dd>
                        <dt>var = "numeric"</dt><dd><p>approx. variance of the estimates of the regression function. Please note that this does not reflect variability due to randomness of weights.</p></dd>
                        <dt>xmin = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>xmax = "numeric"</dt><dd><p>numeric(0)</p></dd>
                        <dt>wghts = "numeric"</dt><dd><p>numeric(0), ratio of distances <code>wghts[-1]/wghts[1]</code></p></dd>
                        <dt>degree = "integer"</dt><dd><p>0</p></dd>
                        <dt>hmax  = "numeric"</dt><dd><p>effective hmax</p></dd>
                        <dt>sigma2  = "numeric"</dt><dd><p>provided or estimated error variance</p></dd>
                        <dt>scorr = "numeric"</dt><dd><p>scorr</p></dd>
                        <dt>family = "character"</dt><dd><p>"Gaussian"</p></dd>
                        <dt>shape = "numeric"</dt><dd><p>NULL</p></dd>
                        <dt>lkern  = "integer"</dt><dd><p>integer code for lkern,
                        1="Plateau", 2="Triangle", 3="Quadratic", 4="Cubic", 5="Gaussian"</p></dd>
                        <dt>lambda = "numeric"</dt><dd><p>effective value of lambda</p></dd>
                        <dt>ladjust = "numeric"</dt><dd><p>effective value of ladjust</p></dd>
                        <dt>aws = "logical"</dt><dd><p>aws</p></dd>
                        <dt>memory = "logical"</dt><dd><p>memory</p></dd>
                        <dt>homogen = "logical"</dt><dd><p>FALSE</p></dd>
                        <dt>earlystop = "logical"</dt><dd><p>FALSE</p></dd>
                        <dt>varmodel = "character"</dt><dd><p>varmodel</p></dd>
                        <dt>vcoef = "numeric"</dt><dd><p>estimated parameters of the variance model</p></dd>
                        <dt>call = "function"</dt><dd><p>the arguments of the call to <code>aws.gaussian</code></p></dd>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function is still experimental and may be changes considerably in future.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>J. Polzehl, H.U. Voss, K. Tabelow (2010). Structural adaptive segmentation for
   statistical parametric mapping, NeuroImage, 52, pp. 515--523. DOI:10.1016/j.neuroimage.2010.04.241</p>
<p>Duembgen, L. and Spokoiny, V. (2001). Multiscale testing of qualitative hypoteses. Ann. Stat. 29, 124--152.</p>
<p>Polzehl, J. and Spokoiny, V. (2006). Propagation-Separation Approach for Local
  Likelihood Estimation. Probability Theory and Related Fields. 3 (135)
  335 - 362. DOI:10.1007/s00440-005-0464-1</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Joerg Polzehl, <a href='mailto:polzehl@wias-berlin.de'>polzehl@wias-berlin.de</a>,
<a href='http://www.wias-berlin.de/people/polzehl/'>http://www.wias-berlin.de/people/polzehl/</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='aws.html'>aws</a></code>, <code><a href='aws.gaussian.html'>aws.gaussian</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='http://www.wias-berlin.de/people/polzehl/'>aws</a></span><span class='op'>)</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Joerg Polzehl.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


