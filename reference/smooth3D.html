<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Auxiliary 3D smoothing routines — smooth3D • aws</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Auxiliary 3D smoothing routines — smooth3D" />
<meta property="og:description" content="smooth3D and medianFilter3D are auxiliary functions for non-adaptive
smoothing of 3D image data using kernel or median smoothing. Both function restrict
to sub-areas determined by a mask.  The functions are used in packages dti and
qMRI.
Functions aws3Dmask and aws3Dmaskfull perform adaptive weights smoothing on
statistical parametric maps in fMRI. Variability of results is determined from smoothed
(using the same weighting schemes) residuals in order to correctly account for spatial
correlation. These functions are intended to be used internally in package fmri.
They have been moved here because they share significant parts of the
openMP parallelized Fortran code underlying function aws." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aws</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Auxiliary 3D smoothing routines</h1>
    
    <div class="hidden name"><code>smooth3D.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>smooth3D</code> and <code>medianFilter3D</code> are auxiliary functions for non-adaptive
smoothing of 3D image data using kernel or median smoothing. Both function restrict
to sub-areas determined by a mask.  The functions are used in packages <code>dti</code> and
<code>qMRI</code>.</p>
<p>Functions <code>aws3Dmask</code> and <code>aws3Dmaskfull</code> perform adaptive weights smoothing on
statistical parametric maps in fMRI. Variability of results is determined from smoothed
(using the same weighting schemes) residuals in order to correctly account for spatial
correlation. These functions are intended to be used internally in package <code>fmri</code>.
They have been moved here because they share significant parts of the
openMP parallelized Fortran code underlying function <code>aws</code>.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>smooth3D</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>h</span>, <span class='va'>mask</span>, lkern <span class='op'>=</span> <span class='st'>"Gaussian"</span>, weighted <span class='op'>=</span> <span class='cn'>FALSE</span>, sigma2 <span class='op'>=</span> <span class='cn'>NULL</span>,
         wghts <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>medianFilter3D</span><span class='op'>(</span><span class='va'>y</span>, h <span class='op'>=</span> <span class='fl'>10</span>, mask <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>aws3Dmask</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>mask</span>, <span class='va'>lambda</span>, <span class='va'>hmax</span>, res <span class='op'>=</span> <span class='cn'>NULL</span>, sigma2 <span class='op'>=</span> <span class='cn'>NULL</span>, lkern <span class='op'>=</span> <span class='st'>"Gaussian"</span>,
   skern <span class='op'>=</span> <span class='st'>"Plateau"</span>, weighted <span class='op'>=</span> <span class='cn'>TRUE</span>, u <span class='op'>=</span> <span class='cn'>NULL</span>, wghts <span class='op'>=</span> <span class='cn'>NULL</span>,
   h0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, testprop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>aws3Dmaskfull</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>mask</span>, <span class='va'>lambda</span>, <span class='va'>hmax</span>, res <span class='op'>=</span> <span class='cn'>NULL</span>, sigma2 <span class='op'>=</span> <span class='cn'>NULL</span>, lkern <span class='op'>=</span> <span class='st'>"Gaussian"</span>,
       skern <span class='op'>=</span> <span class='st'>"Plateau"</span>, weighted <span class='op'>=</span> <span class='cn'>TRUE</span>, u <span class='op'>=</span> <span class='cn'>NULL</span>, wghts <span class='op'>=</span> <span class='cn'>NULL</span>,
       testprop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>3D array of data in case of functions <code>smooth3D</code> and <code>medianFilter3D</code>. For <code>aws3Dmask*</code>
with <code>!is.null(mask)</code> a vector of length <code>sum(mask)</code> containing only data values within the specified mask.</p></td>
    </tr>
    <tr>
      <th>lkern</th>
      <td><p>character: location kernel, either "Triangle", "Plateau", "Quadratic", "Cubic" or "Gaussian".
 The default "Triangle" is equivalent to using an Epanechnikov kernel, "Quadratic" and  "Cubic" refer to a Bi-weight and Tri-weight
  kernel, see Fan and Gijbels (1996). "Gaussian" is a truncated (compact support) Gaussian kernel.
  This is included for comparisons only and should be avoided due to its large computational costs.</p></td>
    </tr>
    <tr>
      <th>weighted</th>
      <td><p>logical: use inverse variances as weights.</p></td>
    </tr>
    <tr>
      <th>sigma2</th>
      <td><p><code>sigma2</code> allows to specify the variance of data entries.</p></td>
    </tr>
    <tr>
      <th>mask</th>
      <td><p>optional logical mask, same dimensionality as <code>y</code></p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>bandwidth to use. In case of <code>lkern="Gaussian"</code> this is in FWHM (full width half maximum) units.
 Value refers to first voxel dimension.</p></td>
    </tr>
    <tr>
      <th>wghts</th>
      <td><p>voxel dimensions. Defaults to <code>c(1,1,1)</code></p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>kritical scale parameter in hypothesis testing (adaptive weights smoothing)</p></td>
    </tr>
    <tr>
      <th>hmax</th>
      <td><p>maximum bandwidth for adaptive weights smoothing</p></td>
    </tr>
    <tr>
      <th>res</th>
      <td><p>array of residuals with dimension <code>c(nres,sum(mask))</code>.</p></td>
    </tr>
    <tr>
      <th>skern</th>
      <td><p><code>skern</code> specifies the kernel for the statistical
penalty. Defaults to "Plateau", the alternatives are "Triangle" and "Exp".
"Plateau" specifies a kernel that is equal to 1 in the interval (0,.3),
decays linearly in (.3,1) and is 0 for arguments larger than 1.
<code>lkern="Plateau"</code> and <code>lkern="Triangle"</code> allow for much faster computation (saves up
to 50% CPU-time). <code>lkern="Plateau"</code> produces a less random weighting scheme.</p></td>
    </tr>
    <tr>
      <th>u</th>
      <td><p>For test purposes in simulations: noisless 3D data.</p></td>
    </tr>
    <tr>
      <th>h0</th>
      <td><p>Vector of 3 bandwidths corresponding to a Gaussian kernel that would produce a
comparable spatial correlation by convoluting iid data.</p></td>
    </tr>
    <tr>
      <th>testprop</th>
      <td><p>logical: test the validity of a propagation condition for the specified value of <code>lambda</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Functions <code>smooth3D</code> and <code>medianFilter3D</code> return a 3D array.
Functions <code>awsmask*</code> return a list with smoothed values of <code>y</code> in
component <code>theta</code> and smoothed residuals in component <code>res</code>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Joerg Polzehl <a href='mailto:polzehl@wias-berlin.de'>polzehl@wias-berlin.de</a>,
  Karsten Tabelow <a href='mailto:tabelow@wias-berlin.de'>tabelow@wias-berlin.de</a></p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Functions <code>awsmask*</code> are used intenally in package <code>fmri</code>. They refer to the
situation, typical for fMRI, where the data are spatially correlated and this correlation
can be accessed using residuals with respect to a model.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Joerg Polzehl.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


